<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å¦‚ä½•å¼•çˆ†ç”¨æˆ¶å¢é•·</title>
<style>
  :root{
    --bg:#0b0f14;--panel:#0f1520;--muted:#94a3b8;--text:#e6edf3;--border:#1f2a3a;--line:#2a3a52;
    --stage:#FFE7C2;--stage-stroke:#C46A00;      /* æ©˜ï¼šStage */
    --tactic:#DCEBFF;--tactic-stroke:#1E63C7;    /* è—ï¼šStrategy */
    --metric:#DFF5E4;--metric-stroke:#247A3A;    /* ç¶ ï¼šMetric */
    --tip-bg:#ffffff;--tip-text:#0f172a;--tip-border:#e2e8f0;
    --focus-ring:#f59e0b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Noto Sans TC,Helvetica,Arial}
  .app{display:grid;grid-template-columns:1.1fr .9fr;gap:12px;min-height:100vh;padding:12px}
  header{grid-column:1/3;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
  .title{font-weight:700}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .toggle,.btn{display:flex;gap:6px;align-items:center;background:var(--panel);border:1px solid var(--border);padding:6px 10px;border-radius:999px;color:var(--muted);cursor:pointer;outline:none; transition: background .2s, color .2s;}
  .toggle:has(input:disabled) { cursor: not-allowed; opacity: 0.5; }
  .container{background:var(--panel);border:1px solid var(--border);border-radius:14px;overflow:hidden}

  /* Focus */
  .toggle:focus-visible,.btn:focus-visible,.node:focus-visible rect{outline:2px solid var(--focus-ring);outline-offset:2px}
  .node:focus-visible rect{stroke:var(--focus-ring)!important;stroke-width:3px!important}

  /* å·¦å´ SVG èˆ‡åœ–ä¾‹ */
  #graphWrap{display:flex;flex-direction:column}
  .legend{display:flex;gap:8px;flex-wrap:wrap;padding:8px 12px;border-top:1px solid var(--border);color:var(--muted)}
  .badge{display:inline-flex;gap:6px;align-items:center;padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:#0b1420}
  .dot{width:10px;height:10px;border-radius:50%}
  svg{width:100%;height:760px;display:block;cursor:default}
  .lane-title{fill:var(--muted);font-size:12px}
  .group-title{fill:var(--muted);font-size:12px;text-anchor:middle; transition: opacity 0.3s ease;}
  .lane-rect{fill:transparent;stroke:var(--line)}
  .node{cursor:pointer; transition: opacity 0.3s ease;}
  .node.filtered-out { opacity: 0.15; pointer-events: none; }
  .node rect{rx:10;ry:10}
  .node text{fill:#1f2937;font-size:12px;pointer-events:none}
  .node .sub{fill:#334155;font-size:11px}
  .stage rect{fill:var(--stage);stroke:var(--stage-stroke);stroke-width:2}
  .tactic rect{fill:var(--tactic);stroke:var(--tactic-stroke)}
  .metric rect{fill:var(--metric);stroke:var(--metric-stroke)}
  .metric text{fill:#065f46}
  .link { transition: opacity 0.3s ease; }
  .link path{stroke:#8da2b5;stroke-width:1.4;fill:none;marker-end:url(#arrow)}
  .link.filtered-out { opacity: 0.1; }
  .link.dashed path{stroke-dasharray:5 4}
  .link.soft path{opacity:.7}
  .emph rect{stroke:#f59e0b!important;stroke-width:3px}
  .emph-link path{stroke:#f59e0b!important;stroke-width:2.2px}
  .tooltip{position:absolute;pointer-events:none;background:var(--tip-bg);color:var(--tip-text);border:1px solid var(--tip-border);padding:8px 10px;border-radius:10px;font-size:12px;opacity:0;box-shadow:0 10px 24px rgba(0,0,0,.2);z-index:100;transition:opacity .2s}

  /* --- å³å´èªªæ˜ (UPDATED) --- */
  .panel{display:flex;flex-direction:column}
  .pane{padding:12px}
  .info-block{
    border:1px solid var(--border);
    border-radius:12px;
    margin:10px 0;
    background:#0c1522;
    display:none; /* JS æ§åˆ¶é¡¯ç¤º */
  }
  .info-block h4{
    padding:10px 12px;
    font-weight:600;
    color:var(--text);
    margin:0;
    border-bottom: 1px solid var(--border);
  }
  .info-block .body{
    padding:12px;
  }
  .muted{color:var(--muted)}

  /* éŸ¿æ‡‰å¼ */
  @media (max-width: 1024px){
    .app{grid-template-columns:1fr}
    header{grid-column:1/1}
    svg{height:auto;aspect-ratio:1220/760}
  }
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="title">å¢é•·æ¨¡å‹äº’å‹•åœ–è­œ</div>
    <div class="toolbar" role="toolbar" aria-label="è¦–åœ–èˆ‡åœ–å±¤åˆ‡æ›">
      <label class="toggle"><input type="radio" name="view" value="overview" checked> ç¸½è¦½</label>
      <label class="toggle"><input type="radio" name="view" value="fly7"> é£›è¼ªæ•ˆæ‡‰</label>
      <label class="toggle"><input type="radio" name="view" value="cold"> ç”¢å“å†·å•Ÿå‹•</label>
      <span style="width:8px; border-left: 1px solid var(--border); margin: 0 4px;"></span>
      <label class="toggle"><input type="checkbox" id="tglDrivers" checked> ä¸ƒå¤§é©…å‹•</label>
      <label class="toggle"><input type="checkbox" id="tglAARRR" checked> AARRR</label>
      <label class="toggle"><input type="checkbox" id="tglMetrics" checked> æ ¸å¿ƒæŒ‡æ¨™</label>
      <label class="toggle"><input type="checkbox" id="tglLoop" checked> è³‡æºé–‰ç’°</label>
      <label class="toggle"><input type="checkbox" id="tglStrategy" checked> ç­–ç•¥</label>
      <button id="btnReset" class="btn" aria-pressed="false">â™»ï¸ é‡ç½®</button>
    </div>
  </header>

  <section class="container" id="graphWrap">
    <svg id="svg" viewBox="0 0 1220 760" xmlns="http://www.w3.org/2000/svg" aria-label="å¢é•·æ¨¡å‹è¦–è¦ºåœ–">
      <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto">
          <path d="M0 0 L10 5 L0 10 Z" fill="#8da2b5"></path>
        </marker>
      </defs>
      <g id="lanes"></g>
      <g id="links"></g>
      <g id="nodes"></g>
      <g id="group-titles"></g>
    </svg>
    <div class="legend">
      <span class="badge"><span class="dot" style="background:var(--stage)"></span>éšæ®µ Stage</span>
      <span class="badge"><span class="dot" style="background:var(--tactic)"></span>åŸå‰‡èˆ‡è¡Œå‹•ç­–ç•¥</span>
      <span class="badge"><span class="dot" style="background:var(--metric)"></span>æŒ‡æ¨™ Metric</span>
      <span class="badge">æç¤ºï¼šç§»ä¸Šçœ‹æç¤ºã€é»æ“Šçœ‹è©³è§£</span>
    </div>
  </section>

  <aside class="container panel">
    <div class="pane">
      <h3 id="ov-title" style="margin:6px 0 0 0">å¢é•·æ¨¡å‹äº’å‹•åœ–è­œ</h3>
      <div class="info-block" id="block-sum">
        <h4>Summary</h4>
        <div id="ov-summary" class="body muted">é»æ“Šå·¦å´ä»»ä¸€åœ–å¡Šï¼Œæˆ–ä½¿ç”¨ä¸Šæ–¹å·¥å…·åˆ—åˆ‡æ›è¦–åœ–èˆ‡ç¯©é¸ï¼Œä¾†æ¢ç´¢å¢é•·æ¨¡å‹ã€‚</div>
      </div>
      <div class="info-block" id="block-kpi">
        <h4>KPI / æ¨¡å‹</h4>
        <div id="ov-kpi" class="body"></div>
      </div>
      <div class="info-block" id="block-rel">
        <h4>é—œè¯èˆ‡ä¸²è¯</h4>
        <div id="ov-rel" class="body"></div>
      </div>
      <div class="info-block" id="block-pb">
        <h4>å¯åŸ·è¡Œä½œæ³•</h4>
        <div id="ov-pb" class="body"></div>
      </div>
    </div>
  </aside>
</div>

<div id="tip" class="tooltip" role="tooltip" aria-live="polite"></div>

<script>
(function(){
  const svg = document.getElementById('svg');
  const gLanes = svg.querySelector('#lanes');
  const gLinks = svg.querySelector('#links');
  const gNodes = svg.querySelector('#nodes');
  const gGroupTitles = svg.querySelector('#group-titles');
  const tip = document.getElementById('tip');
  const $ = (s,el=document)=>el.querySelector(s);
  const $$ = (s,el=document)=>[...el.querySelectorAll(s)];

  /* ===================== è³‡æ–™å®šç¾© Start ===================== */
  const OVERVIEW = {
    lanes:[
      { id:'L0', title:'ä¸ƒå¤§å¢é•·é©…å‹•', x:40,  w:1140, y:40,  h:90  },
      { id:'L1', title:'AARRR æ¨¡å‹', x:40,  w:1140, y:155, h:95 },
      { id:'L2', title:'æ ¸å¿ƒæŒ‡æ¨™å€', x:40,  w:1140, y:275, h:110 },
      { id:'L3', title:'è³‡æºé–‰ç’°', x:40, w:1140, y:410, h:100 },
      { id:'L4', title:'å¯åŸ·è¡Œç­–ç•¥ (Playbooks)', x:40,  w:1140, y:540, h:180 }
    ],
    groupTitles:[
      { text:'ç²å®¢ç­–ç•¥', x:250, y:565 },
      { text:'ç•™å­˜ç­–ç•¥', x:530, y:565 },
      { text:'è®Šç¾ç­–ç•¥', x:810, y:565 },
      { text:'å†æŠ•è³‡ç­–ç•¥', x:1055,y:565 },
    ],
    nodes:[
      {id:'DRV_SUP', lane:'L0', x:120, y:85, type:'tactic', title:'ä¾›çµ¦é©…å‹•', sub:'è£œè¶³/æ“´ä¾›çµ¦', w:140},
      {id:'DRV_USR', lane:'L0', x:280, y:85, type:'tactic', title:'ç”¨æˆ¶é©…å‹•', sub:'æ‹‰æ–°ç•™å­˜å‚³æ’­', w:140},
      {id:'DRV_PRD', lane:'L0', x:440, y:85, type:'tactic', title:'ç”¢å“é©…å‹•', sub:'é™é–€æª»æè½‰åŒ–', w:140},
      {id:'DRV_CHN', lane:'L0', x:600, y:85, type:'tactic', title:'æ¸ é“é©…å‹•', sub:'é«˜æ•ˆä½æˆæœ¬', w:140},
      {id:'DRV_EVT', lane:'L0', x:760, y:85, type:'tactic', title:'æ´»å‹•é©…å‹•', sub:'ç¯€é»å¼•çˆ†', w:140},
      {id:'DRV_DAT', lane:'L0', x:920, y:85, type:'tactic', title:'æ•¸æ“šé©…å‹•', sub:'ç™¼ç¾ç“¶é ¸è¿­ä»£', w:140},
      {id:'DRV_BRD', lane:'L0', x:1080,y:85, type:'tactic', title:'å“ç‰Œé©…å‹•', sub:'ä¿¡ä»»å¿ƒæ™º', w:140},
      {id:'AQ',  lane:'L1', x:150,  y:200, type:'tactic', title:'Acquisition', sub:'è§¸é”/å®‰è£'},
      {id:'ACT', lane:'L1', x:380,  y:200, type:'tactic', title:'Activation',  sub:'é¦–æ¬¡æˆåŠŸé«”é©—'},
      {id:'RTN', lane:'L1', x:610,  y:200, type:'tactic', title:'Retention',   sub:'æŒçºŒä½¿ç”¨/å›è¨ª'},
      {id:'REV', lane:'L1', x:840,  y:200, type:'tactic', title:'Revenue',     sub:'ä»˜è²»/äº¤æ˜“'},
      {id:'REF', lane:'L1', x:1070, y:200, type:'tactic', title:'Referral',    sub:'æ¨è–¦/å£ç¢‘'},
      {id:'NSM', lane:'L2', x:190,  y:325, type:'metric', title:'åŒ—æ¥µæ˜ŸæŒ‡æ¨™', sub:'North Star Metric', w:220},
      {id:'CAC', lane:'L2', x:420,  y:325, type:'metric', title:'CAC & Payback', sub:'ç²å®¢æˆæœ¬èˆ‡å›æœ¬é€±æœŸ', w:200},
      {id:'RFM', lane:'L2', x:630,  y:325, type:'metric', title:'RFM',  sub:'ç”¨æˆ¶åˆ†å±¤æ¨¡å‹', w:160},
      {id:'ARPU',lane:'L2', x:840,  y:325, type:'metric', title:'ARPU', sub:'å–®ç”¨æˆ¶å¹³å‡æ”¶å…¥', w:180},
      {id:'LTV', lane:'L2', x:1050, y:325, type:'metric', title:'LTV',  sub:'ç”¨æˆ¶çµ‚èº«åƒ¹å€¼', w:160},
      {id:'A', lane:'L3', x:250,  y:460, type:'stage',  title:'ç²å®¢', sub:'Acquire'},
      {id:'B', lane:'L3', x:530,  y:460, type:'stage',  title:'ç•™å­˜', sub:'Retain'},
      {id:'C', lane:'L3', x:810,  y:460, type:'stage',  title:'è®Šç¾', sub:'Monetize'},
      {id:'D', lane:'L3', x:1055, y:460, type:'stage',  title:'å†æŠ•è³‡', sub:'Re-invest'},
      {id:'A1', lane:'L4', x:160, y:600, type:'tactic', title:'å»£å‘ŠæŠ•æ”¾', w:160},
      {id:'A2', lane:'L4', x:340, y:600, type:'tactic', title:'è£œè²¼æ¿€å‹µ', w:160},
      {id:'A3', lane:'L4', x:160, y:660, type:'tactic', title:'ç•°æ¥­åˆä½œ', w:160},
      {id:'BX1',lane:'L4', x:340, y:660, type:'tactic', title:'å±•æœƒ/BDæ‹“å®¢', w:160},
      {id:'B1', lane:'L4', x:530, y:600, type:'tactic', title:'æ–°æ‰‹å¼•å°', w:160},
      {id:'B2', lane:'L4', x:530, y:660, type:'tactic', title:'å ´æ™¯ç¶å®š', w:160},
      {id:'C1', lane:'L4', x:720, y:600, type:'tactic', title:'æé«˜å®¢å–®åƒ¹(M)', w:160},
      {id:'C2', lane:'L4', x:890, y:600, type:'tactic', title:'æé«˜é »æ¬¡(F)', w:160},
      {id:'C3', lane:'L4', x:810, y:660, type:'tactic', title:'äº¤å‰éŠ·å”®/é‡‘è', w:180},
      {id:'D1', lane:'L4', x:1055,y:600, type:'tactic', title:'LTV/CACåˆ†æ', w:160},
      {id:'D2', lane:'L4', x:1055,y:660, type:'tactic', title:'å„ªåŒ–ROIæ¸ é“', w:160},
    ],
    links:[
      ['DRV_USR','A'], ['DRV_PRD','B'], ['DRV_CHN','A'], ['DRV_DAT','D'], ['DRV_BRD','C'],
      ['AQ','A'],['ACT','B'],['RTN','B'],['REV','C'],['REF','A'],
      ['A','NSM'],['B','NSM'],['C','NSM'], ['A','CAC'], ['B','RFM'],['C','ARPU'],['D','LTV'],
      ['A1','AQ'], ['A2','ACT'], ['A3','AQ'], ['BX1','AQ'],
      ['B1','ACT'], ['B2','RTN'],
      ['C1','REV'], ['C2','REV'], ['C3','REV'],
      ['D1','D'], ['D2','A'],
      ['A','B','main'],['B','C','main'],['C','D','main'],['D','A','main'],
    ]
  };
  const FLY7 = {
    lanes:[], nodes:(()=>{ const cx=620, cy=380, r=260; const s=[ {id:'S1',title:'01 ä½åƒ¹/é«˜åƒ¹å€¼\nå¸å¼•ç”¨æˆ¶'}, {id:'S2',title:'02 æ‹‰é€²æ›´å¤š\né«˜æ½›åŠ›ç”¨æˆ¶'}, {id:'S3',title:'03 æ“´å¤§ç”¢å“/\nå ´æ™¯è¦†è“‹'}, {id:'S4',title:'04 æå‡é«”é©—\nèˆ‡å›é¥‹'}, {id:'S5',title:'05 æ´»èºç”¨æˆ¶\nå›æµèˆ‡æ¨è–¦'}, {id:'S6',title:'06 è¦æ¨¡æ“´å¤§\næ•¸æ“šâ†‘ ç²¾æº–â†‘'}, {id:'S7',title:'07 CACâ†“ ARPUâ†‘\nå›åˆ° S1'} ]; return s.map((t,i)=>{const a=(Math.PI*2/s.length)*i-Math.PI/2; const x=cx+r*Math.cos(a), y=cy+r*Math.sin(a); return {id:t.id,x,y,type:'stage',title:t.title,w:160,h:56};}); })(),
    links:[['S1','S2'],['S2','S3'],['S3','S4'],['S4','S5'],['S5','S6'],['S6','S7'],['S7','S1']]
  };
  const COLD = {
    lanes:[],
    nodes:[
      {id:'CS_HUB', x:610, y:200, type:'stage', title:'ç”¢å“å†·å•Ÿå‹•', sub:'å¾0åˆ°1çš„å…­ç¨®ç­–ç•¥', w:220, h:70},
      {id:'CS1', x:300, y:400, type:'tactic', title:'åäººæ•ˆæ‡‰', sub:'KOLèƒŒæ›¸å¼•æµ', w:220},
      {id:'CS2', x:610, y:400, type:'tactic', title:'çˆ†æ¬¾ç”¢å“', sub:'ä»¥é»å¸¶é¢', w:220},
      {id:'CS3', x:920, y:400, type:'tactic', title:'é¦¬ç”²æ•ˆæ‡‰', sub:'å¤šå“ç‰Œæ“´è²é‡', w:220},
      {id:'CS4', x:300, y:550, type:'tactic', title:'ç¨®å­ç‰¹æ¬Š', sub:'å…±å‰µèˆ‡å…§æ¸¬', w:220},
      {id:'CS5', x:610, y:550, type:'tactic', title:'å®šå‘é‚€è«‹', sub:'ç²¾æº–é—œä¿‚éˆè£‚è®Š', w:220},
      {id:'CS6', x:920, y:550, type:'tactic', title:'åª’é«”å ±å°', sub:'è£½é€ è©±é¡Œæ›å…‰', w:220},
    ],
    links:[
      ['CS_HUB','CS1'], ['CS_HUB','CS2'], ['CS_HUB','CS3'],
      ['CS_HUB','CS4'], ['CS_HUB','CS5'], ['CS_HUB','CS6']
    ]
  };

  const DB = { /* ... å®Œæ•´ DB è³‡æ–™ ... */ };
  (DB.DRV_SUP = {s:'ä¾›çµ¦é©…å‹•', sum:'å‰µé€ æˆ–æ“´å¤§æœ‰æ•ˆä¾›çµ¦ï¼Œä»¥åŒ¹é…ä¸¦åˆºæ¿€éœ€æ±‚ã€‚æ˜¯é›™é‚Šå¹³å°çš„åŸºç¤ã€‚', kpi:'<ul><li>ä¾›çµ¦å´è¦†è“‹ç‡ï¼ˆåœ°åŸŸ/å“é¡ï¼‰</li><li>æœ‰æ•ˆ SKU / å¯æœå‹™å ´æ™¯æ•¸é‡</li></ul>', link:'ä¾›çµ¦è¶Šè±å¯Œã€å“è³ªè¶Šå¥½ï¼Œç”¨æˆ¶é«”é©—å’Œç•™å­˜å°±è¶Šé«˜ï¼Œé€²è€Œæ‹‰å‹•æ›´å¤šéœ€æ±‚ã€‚', pb:'åˆæœŸé‡é»è£œè¶³çŸ­æ¿å“é¡æˆ–æ ¸å¿ƒå ´æ™¯ï¼›ä¸­æœŸéœ€å¹³è¡¡ä¾›éœ€å…©ç«¯ï¼Œé¿å…è³‡æºéŒ¯é…ã€‚'}), (DB.DRV_USR = {s:'ç”¨æˆ¶é©…å‹•', sum:'åœç¹ç”¨æˆ¶ç”Ÿå‘½é€±æœŸçš„ã€Œé–‹æºç¯€æµã€ï¼ŒåŒ…å«æ‹‰æ–°ã€æ¿€æ´»ã€ç•™å­˜ã€å‚³æ’­ã€é˜²æµå¤±ç­‰ã€‚', kpi:'<ul><li>æ–°å¢ç”¨æˆ¶æ•¸ (New Users)</li><li>ç”¨æˆ¶ç•™å­˜ç‡ (Retention Rate)</li><li>ç—…æ¯’ä¿‚æ•¸ (K-Factor)</li></ul>', link:'é©…å‹•æ•´å€‹ AARRR æ¨¡å‹çš„é‹è½‰ï¼Œæ˜¯å¢é•·çš„æ ¸å¿ƒå¼•æ“ã€‚', pb:'ç”¨æˆ¶åˆ†å±¤é‹ç‡Ÿï¼Œé‡å°ä¸åŒåƒ¹å€¼å’Œæ´»èºåº¦çš„ç”¨æˆ¶ï¼Œæ¡å–å·®ç•°åŒ–ç­–ç•¥ã€‚'}), (DB.DRV_PRD = {s:'ç”¢å“é©…å‹•', sum:'é€éç”¢å“è‡ªèº«çš„é«”é©—ã€åŠŸèƒ½å’Œå‰µæ–°ï¼Œé™ä½ä½¿ç”¨é–€æª»ã€æå‡æ ¸å¿ƒç’°ç¯€è½‰åŒ–ç‡ã€‚', kpi:'<ul><li>é—œéµä»»å‹™å®Œæˆç‡ (Task Success Rate)</li><li>é¦–æ¬¡åƒ¹å€¼é«”é©—æ™‚é–“ (TTFV)</li><li>ç”¨æˆ¶æ»¿æ„åº¦ (NPS/CSAT)</li></ul>', link:'ä¸»è¦æ‰¿æ¥ AARRR ä¸­çš„ã€ŒActivationã€ï¼Œä¸¦æ·±åˆ»å½±éŸ¿ã€ŒRetentionã€ã€‚', pb:'å„ªåŒ–æ ¸å¿ƒæµç¨‹ï¼Œæ¸›å°‘æ“ä½œæ­¥é©Ÿï¼›è¨­è¨ˆã€ŒAha! Momentã€ï¼Œè®“ç”¨æˆ¶å¿«é€Ÿæ„Ÿå—åƒ¹å€¼ã€‚'}), (DB.DRV_CHN = {s:'æ¸ é“é©…å‹•', sum:'æŒçºŒå°‹æ‰¾ä¸¦å„ªåŒ–é«˜æ•ˆç‡ã€ä½æˆæœ¬çš„æµé‡ä¾†æºï¼Œå»ºç«‹ç©©å®šçš„ç²å®¢æ¸ é“çŸ©é™£ã€‚', kpi:'<ul><li>æ¸ é“ç²å®¢æˆæœ¬ (CAC by Channel)</li><li>å»£å‘ŠæŠ•è³‡å›å ±ç‡ (ROAS)</li><li>æ¸ é“è½‰æ›ç‡ (CVR)</li></ul>', link:'ç›´æ¥å°æ‡‰ AARRR ä¸­çš„ã€ŒAcquisitionã€å’Œè³‡æºé–‰ç’°çš„ã€Œç²å®¢ã€éšæ®µã€‚', pb:'é€²è¡Œæ¸ é“çµ„åˆæ¸¬è©¦ï¼Œæ‰¾åˆ°æœ€é©åˆçš„1-3å€‹æ ¸å¿ƒæ¸ é“ï¼Œä¸¦è¦æ¨¡åŒ–æŠ•æ”¾ã€‚'}), (DB.DRV_EVT = {s:'æ´»å‹•é©…å‹•', sum:'åœ¨ç‰¹å®šæ™‚é–“ç¯€é»ï¼ˆå¦‚ç¯€å‡æ—¥ã€å¤§äº‹ä»¶ï¼‰ç­–åŠƒå¸‚å ´æ´»å‹•ï¼ŒçŸ­æœŸå…§å¼•çˆ†æµé‡èˆ‡äº¤æ˜“é«˜å³°ã€‚', kpi:'<ul><li>æ´»å‹•æœŸé–“æ–°å¢ç”¨æˆ¶/è¨‚å–®é‡</li><li>æ´»å‹•å¸¶ä¾†çš„é«˜å³°æ—¥/æ™‚æ´» (Peak DAU/HAU)</li></ul>', link:'ä¸»è¦ä½œç”¨æ–¼ã€ŒAcquisitionã€å’Œã€ŒRevenueã€ï¼Œä½†éœ€æœ‰ã€ŒRetentionã€ç­–ç•¥é…åˆï¼Œé˜²æ­¢ç”¨æˆ¶ç”¨å®Œå³èµ°ã€‚', pb:'è¨­è¨ˆæ´»å‹•å‰é ç†±ã€æ´»å‹•ä¸­å¼•çˆ†ã€æ´»å‹•å¾Œç•™å­˜çš„å…¨éˆè·¯ã€‚'}), (DB.DRV_DAT = {s:'æ•¸æ“šé©…å‹•', sum:'å»ºç«‹ã€ŒæŒ‡æ¨™ç›£æ§-æ´å¯Ÿç™¼ç¾-ç­–ç•¥å‡è¨­-å¯¦é©—é©—è­‰-è¿­ä»£å„ªåŒ–ã€çš„æ•¸æ“šé©…å‹•è¿´åœˆã€‚', kpi:'<ul><li>æ ¸å¿ƒæŒ‡æ¨™é”æˆç‡</li><li>AB å¯¦é©—æˆåŠŸç‡èˆ‡è¿­ä»£é€Ÿåº¦</li></ul>', link:'ç‚ºæ‰€æœ‰å…¶ä»–é©…å‹•æ–¹å¼æä¾›æ±ºç­–ä¾æ“šï¼Œç™¼ç¾ç“¶é ¸ä¸¦è¡¡é‡æ•ˆæœã€‚', pb:'æ­å»ºæ•¸æ“šçœ‹æ¿ï¼Œè¦ç¯„äº‹ä»¶åŸ‹é»èˆ‡æ­¸å› æ¨¡å‹ï¼Œå»ºç«‹å¿«é€Ÿå¯¦é©—çš„èƒ½åŠ›ã€‚'}), (DB.DRV_BRD = {s:'å“ç‰Œé©…å‹•', sum:'é€éé•·æœŸä¸€è‡´çš„åƒ¹å€¼å‚³éï¼Œå»ºç«‹ç”¨æˆ¶ä¿¡ä»»å’Œå¿ƒæ™ºä½”æœ‰ç‡ï¼Œå¾è€Œé™ä½é•·æœŸç²å®¢å’Œæ±ºç­–æˆæœ¬ã€‚', kpi:'<ul><li>å“ç‰Œæ·¨æ¨è–¦å€¼ (NPS)</li><li>å“ç‰Œé—œéµå­—æœå°‹é‡</li><li>ç„¡æç¤ºç¬¬ä¸€æåŠç‡ (Top of Mind)</li></ul>', link:'å…¨é¢å½±éŸ¿è½‰åŒ–ç‡ã€å¾©è³¼ç‡å’Œæ¨è–¦ç‡ï¼Œæ˜¯å¢é•·çš„æ”¾å¤§å™¨ã€‚', pb:'æŒçºŒè¼¸å‡ºä¸€è‡´çš„å“ç‰Œè¨Šæ¯ï¼Œç©æ¥µç®¡ç†ç”¨æˆ¶å£ç¢‘èˆ‡è©•åƒ¹ã€‚'}), (DB.AQ = {s:'Acquisition (ç²å–)', sum:'å¾å„ç¨®æ¸ é“è®“æ½›åœ¨ç”¨æˆ¶é¦–æ¬¡æ¥è§¸ã€è¨ªå•ã€å®‰è£æˆ–è¨»å†Šç”¢å“ã€‚', kpi:'<ul><li>æ›å…‰é‡ã€é»æ“Šç‡ (CTR)</li><li>å®‰è£/è¨»å†Šè½‰æ›ç‡ (CVR)</li></ul>', link:'å°æ‡‰ã€Œæ¸ é“é©…å‹•ã€ï¼Œä¸¦æµå…¥è³‡æºé–‰ç’°çš„ã€Œç²å®¢ã€éšæ®µã€‚', pb:'å„ªåŒ–è½åœ°é (Landing Page)ï¼Œç°¡åŒ–è¨»å†Šæµç¨‹ï¼ŒA/B æ¸¬è©¦å»£å‘Šç´ æã€‚'}), (DB.ACT = {s:'Activation (æ¿€æ´»)', sum:'å¼•å°æ–°ç”¨æˆ¶å®Œæˆèƒ½é«”é©—åˆ°ç”¢å“æ ¸å¿ƒåƒ¹å€¼çš„é—œéµè¡Œç‚ºï¼Œå³ã€ŒAha! Momentã€ã€‚', kpi:'<ul><li>æ–°ç”¨æˆ¶é¦–æ—¥/ä¸ƒæ—¥æ´»èºç‡</li><li>é—œéµè¡Œç‚ºå®Œæˆç‡ï¼ˆå¦‚ï¼šç™¼å¸ƒç¬¬ä¸€å¼µç…§ç‰‡ï¼‰</li></ul>', link:'å°æ‡‰ã€Œç”¢å“é©…å‹•ã€ï¼Œæ˜¯å¾ã€Œç²å®¢ã€åˆ°ã€Œç•™å­˜ã€çš„é—œéµæ©‹æ¨‘ã€‚', pb:'è¨­è¨ˆæ–°æ‰‹å¼•å° (Onboarding)ï¼Œæä¾›é¦–å–®å„ªæƒ æˆ–ä»»å‹™çå‹µã€‚'}), (DB.RTN = {s:'Retention (ç•™å­˜)', sum:'è®“ç”¨æˆ¶åœ¨åˆæ¬¡é«”é©—å¾Œï¼ŒæŒçºŒã€è¦å¾‹åœ°å›ä¾†ä½¿ç”¨ç”¢å“ã€‚', kpi:'<ul><li>æ¬¡æ—¥ã€7æ—¥ã€30æ—¥ç•™å­˜ç‡</li><li>ç”¨æˆ¶æµå¤±ç‡ (Churn Rate)</li></ul>', link:'å°æ‡‰è³‡æºé–‰ç’°çš„ã€Œç•™å­˜ã€éšæ®µï¼Œæ˜¯å•†æ¥­æ¨¡å¼æˆç«‹çš„åŸºçŸ³ã€‚', pb:'å»ºç«‹å¬å›æ©Ÿåˆ¶ï¼ˆPush/Emailï¼‰ï¼Œç¶å®šé«˜é »ä½¿ç”¨å ´æ™¯ï¼Œæ¨å‡ºæœƒå“¡é«”ç³»ã€‚'}), (DB.REV = {s:'Revenue (è®Šç¾)', sum:'å°‡ç”¨æˆ¶çš„æ´»èºè¡Œç‚ºï¼Œé€éå„ç¨®æ–¹å¼è½‰åŒ–ç‚ºå¯¦éš›æ”¶å…¥ã€‚', kpi:'<ul><li>ä»˜è²»è½‰åŒ–ç‡</li><li>æ¯ç”¨æˆ¶å¹³å‡æ”¶å…¥ (ARPU)</li><li>ä»˜è²»ç”¨æˆ¶å¹³å‡æ”¶å…¥ (ARPPU)</li></ul>', link:'å°æ‡‰è³‡æºé–‰ç’°çš„ã€Œè®Šç¾ã€éšæ®µï¼Œé©—è­‰å•†æ¥­åƒ¹å€¼ã€‚', pb:'æå‡å®¢å–®åƒ¹ (M) å’Œè³¼è²·é »æ¬¡ (F)ï¼Œæ¢ç´¢è¨‚é–±ã€å¢å€¼æœå‹™ç­‰æ¨¡å¼ã€‚'}), (DB.REF = {s:'Referral (æ¨è–¦)', sum:'æ¿€å‹µæ»¿æ„ç”¨æˆ¶è‡ªç™¼åœ°å°‡ç”¢å“æ¨è–¦çµ¦ä»–äººï¼Œå½¢æˆç—…æ¯’å¼å‚³æ’­ã€‚', kpi:'<ul><li>ç—…æ¯’ä¿‚æ•¸ K-Factor = (æ¯ç”¨æˆ¶ç™¼å‡ºé‚€è«‹æ•¸) * (é‚€è«‹è½‰åŒ–ç‡)</li></ul>', link:'æ˜¯æˆæœ¬æœ€ä½çš„ç²å®¢æ–¹å¼ï¼Œç›´æ¥åå“ºã€ŒAcquisitionã€éšæ®µï¼Œå½¢æˆå¢é•·é£›è¼ªã€‚', pb:'è¨­è¨ˆé›™å‘çå‹µæ©Ÿåˆ¶ï¼Œç°¡åŒ–åˆ†äº«æµç¨‹ï¼Œæä¾›æ˜“æ–¼å‚³æ’­çš„å…§å®¹ã€‚'}), (DB.NSM = {s:'åŒ—æ¥µæ˜ŸæŒ‡æ¨™', sum:'æ˜¯å…¨å…¬å¸ã€å…¨åœ˜éšŠåœ¨ç‰¹å®šéšæ®µå…§ï¼Œå…±åŒè¿½æ±‚çš„å”¯ä¸€æ ¸å¿ƒæŒ‡æ¨™ï¼Œä»£è¡¨äº†ç”¢å“ç‚ºç”¨æˆ¶å‰µé€ çš„æ ¸å¿ƒåƒ¹å€¼ã€‚', kpi:'<ul><li>å¹³å°å‹ï¼šæœˆ/é€±æ´»äº¤æ˜“ç”¨æˆ¶æ•¸ã€ç¸½äº¤æ˜“é¡ (GMV)</li><li>å…§å®¹å‹ï¼šæ ¸å¿ƒç”¨æˆ¶çš„ç¸½é–±è®€/è§€çœ‹æ™‚é•·</li></ul>', link:'ä¸²è¯ç²å®¢(A)ã€ç•™å­˜(B)ã€è®Šç¾(C)ä¸‰å€‹éšæ®µï¼Œç¢ºä¿æ‰€æœ‰å¢é•·æ´»å‹•éƒ½æœåŒä¸€å€‹æ–¹å‘åŠªåŠ›ã€‚', pb:'æ¯å­£æˆ–æ¯åŠå¹´é‡æ–°æ ¡æº–åŒ—æ¥µæ˜ŸæŒ‡æ¨™ï¼Œç¢ºä¿å…¶ä»åæ˜ ç•¶å‰éšæ®µçš„æ ¸å¿ƒç”¨æˆ¶åƒ¹å€¼ã€‚'}), (DB.CAC = {s:'CAC & Payback', sum:'ç²å®¢æˆæœ¬(CAC)æŒ‡ç²å–å–®ä¸€æ–°ç”¨æˆ¶æ‰€éœ€çš„ç¸½èŠ±è²»ã€‚å›æœ¬é€±æœŸ(Payback Period)æŒ‡éœ€è¦å¤šä¹…æ‰èƒ½å¾è©²ç”¨æˆ¶èº«ä¸Šè³ºå›ç²å®¢æˆæœ¬ã€‚', kpi:'<ul><li>CAC = ç¸½å¸‚å ´èˆ‡éŠ·å”®è²»ç”¨ / æ–°å¢ç”¨æˆ¶æ•¸</li><li>Payback (æœˆ) = CAC / (ARPU Ã— æ¯›åˆ©ç‡)</li></ul>', link:'CAC æ˜¯ã€Œç²å®¢ã€éšæ®µçš„ç›´æ¥ç”¢å‡ºï¼ŒPayback å‰‡é—œè¯ã€Œå†æŠ•è³‡ã€æ±ºç­–ã€‚', pb:'åˆ†æ¸ é“è¨ˆç®— CACï¼Œä¸¦è¨­å®šä¸Šé™ï¼›åŠªåŠ›ç¸®çŸ­å›æœ¬é€±æœŸï¼Œæå‡è³‡é‡‘æ•ˆç‡ã€‚'}), (DB.RFM = {s:'RFM ç”¨æˆ¶åˆ†å±¤', sum:'ä¸€ç¨®ç¶“å…¸çš„ç”¨æˆ¶åƒ¹å€¼åˆ†ææ¨¡å‹ï¼Œæ ¹æ“šç”¨æˆ¶æœ€è¿‘ä¸€æ¬¡æ¶ˆè²»(Recency)ã€æ¶ˆè²»é »ç‡(Frequency)ã€æ¶ˆè²»é‡‘é¡(Monetary)ä¸‰å€‹ç¶­åº¦é€²è¡Œåˆ†ç¾¤ã€‚', kpi:'<ul><li>å°‡ç”¨æˆ¶åˆ†ç‚ºï¼šé‡è¦åƒ¹å€¼ã€é‡è¦ä¿æŒã€é‡è¦ç™¼å±•ã€ä¸€èˆ¬æŒ½ç•™ç­‰8å€‹ç¾¤é«”ã€‚</li></ul>', link:'ä¸»è¦æ‡‰ç”¨æ–¼ã€Œç•™å­˜ã€éšæ®µï¼Œæ˜¯å¯¦ç¾ç²¾ç´°åŒ–é‹ç‡Ÿçš„åŸºç¤ã€‚', pb:'å°ä¸åŒåˆ†å±¤çš„ç”¨æˆ¶ï¼Œæ¨é€ä¸åŒçš„è¨Šæ¯ã€æ´»å‹•å’Œå®¢æˆ¶é—œæ‡·ç­–ç•¥ã€‚'}), (DB.ARPU = {s:'ARPU', sum:'(Average Revenue Per User) åœ¨ç‰¹å®šæ™‚é–“å…§ï¼Œå¾æ¯å€‹æ´»èºç”¨æˆ¶èº«ä¸Šå¹³å‡ç²å¾—çš„æ”¶å…¥ã€‚', kpi:'<ul><li>ARPU = ç¸½æ”¶å…¥ / ç¸½æ´»èºç”¨æˆ¶æ•¸</li></ul>', link:'ã€Œè®Šç¾ã€éšæ®µçš„æ ¸å¿ƒè¡¡é‡æ¨™æº–ã€‚', pb:'é€éæé«˜å®¢å–®åƒ¹(M)æˆ–æå‡è³¼è²·é »æ¬¡(F)ä¾†æ‹‰å‹• ARPUã€‚'}), (DB.LTV = {s:'LTV', sum:'(Lifetime Value) ç”¨æˆ¶çµ‚èº«åƒ¹å€¼ï¼ŒæŒ‡é æœŸå¾å–®ä¸€ç”¨æˆ¶åœ¨æ•´å€‹ç”Ÿå‘½é€±æœŸå…§ç²å¾—çš„ç¸½åˆ©æ½¤ã€‚', kpi:'<ul><li>LTV â‰ˆ ARPU Ã— (1 / æµå¤±ç‡) Ã— æ¯›åˆ©ç‡</li></ul>', link:'æ˜¯ã€Œå†æŠ•è³‡ã€éšæ®µçš„é—œéµæ±ºç­–ä¾æ“šã€‚å¥åº·çš„æ¥­å‹™è¦æ±‚ LTV > CACã€‚', pb:'æå‡ç•™å­˜ç‡æ˜¯æé«˜ LTV æœ€æœ‰æ•ˆçš„æ–¹æ³•ã€‚'}), (DB.A = {s:'ğŸ¯ ç²å®¢ (Acquire)', sum:'æŠ•å…¥è³‡æºï¼ˆäººåŠ›ã€è³‡é‡‘ï¼‰ç²å–æ–°ç”¨æˆ¶ã€‚', link:'ç”±ä¸Šå±¤ã€Œå¢é•·é©…å‹•ã€å’Œã€ŒAARRRã€æ¨¡å‹æŒ‡å°ï¼Œå‘ä¸‹é©…å‹•å…·é«”çš„ã€Œç²å®¢ç­–ç•¥ã€ã€‚', pb:''}), (DB.B = {s:'ğŸ¤ ç•™å­˜ (Retain)', sum:'é€éå„ªè³ªçš„ç”¢å“å’Œé‹ç‡Ÿï¼Œè®“ç”¨æˆ¶ç•™ä¸‹ä¾†ä¸¦æŒçºŒæ´»èºã€‚', link:'æ‰¿æ¥ã€Œç²å®¢ã€æˆæœï¼Œæ˜¯å•†æ¥­æ¨¡å¼çš„åŸºç¤ï¼Œæ”¯æ’å¾ŒçºŒçš„ã€Œè®Šç¾ã€ã€‚', pb:''}), (DB.C = {s:'ğŸ’° è®Šç¾ (Monetize)', sum:'å°‡æ´»èºç”¨æˆ¶è½‰åŒ–ç‚ºæ”¶å…¥ï¼Œé©—è­‰å•†æ¥­æ¨¡å¼ã€‚', link:'åŸºæ–¼ç©©å®šçš„ã€Œç•™å­˜ã€ï¼Œå°‡ç”¨æˆ¶åƒ¹å€¼è½‰åŒ–ç‚ºå•†æ¥­åƒ¹å€¼ã€‚', pb:''}), (DB.D = {s:'ğŸš€ å†æŠ•è³‡ (Re-invest)', sum:'å°‡ç²å¾—çš„åˆ©æ½¤ï¼Œä»¥ LTV/CAC ç‚ºæ¨™å°ºï¼Œé‡æ–°æŠ•å…¥åˆ°ç²å®¢æ¸ é“ä¸­ï¼Œå½¢æˆè¦æ¨¡åŒ–çš„å¢é•·å¾ªç’°ã€‚', link:'é–‰ç’°çš„çµ‚é»ï¼Œä¹Ÿæ˜¯ä¸‹ä¸€è¼ªå¢é•·çš„èµ·é»ï¼Œé©…å‹•é£›è¼ªåŠ é€Ÿã€‚', pb:''}), (DB.A1 = {s:'å»£å‘ŠæŠ•æ”¾', sum:'åœ¨å„å¤§æµé‡å¹³å°ï¼ˆå¦‚ Google, Metaï¼‰è³¼è²·å»£å‘Šï¼Œç²¾æº–è§¸é”ç›®æ¨™ç”¨æˆ¶ã€‚<br><br><b>[é©ç”¨å°è±¡] C ç«¯</b>', pb:'A/B æ¸¬è©¦å»£å‘Šç´ æã€å—çœ¾å’Œè½åœ°é ï¼ŒæŒçºŒå„ªåŒ– ROASã€‚'}), (DB.A2 = {s:'è£œè²¼æ¿€å‹µ', sum:'é€éé¦–å–®ç«‹æ¸›ã€è¨»å†Šç´…åŒ…ç­‰æ–¹å¼ï¼Œç”¨é‡‘éŒ¢æ›å–ç”¨æˆ¶çš„å¿«é€Ÿè¡Œå‹•ã€‚<br><br><b>[é©ç”¨å°è±¡] C ç«¯</b>', pb:'è¨­å®šæ˜ç¢ºçš„æ­¢æç·šï¼Œä¸¦é…åˆé¢¨æ§ç³»çµ±ï¼Œé˜²æ­¢è¢«ã€Œç¾Šæ¯›é»¨ã€æ¿«ç”¨ã€‚'}), (DB.A3 = {s:'ç•°æ¥­åˆä½œ', sum:'èˆ‡æ¥­å‹™äº’è£œã€ç”¨æˆ¶ç¾¤ç›¸ä¼¼çš„å“ç‰Œåˆä½œï¼Œé€²è¡Œæµé‡äº’æ›æˆ–è¯åˆæ´»å‹•ã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯ã€C ç«¯</b>', pb:'å„ªå…ˆé¸æ“‡èƒ½ä»¥ CPA/CPS (æŒ‰æ•ˆæœä»˜è²») æ–¹å¼åˆä½œçš„å¤¥ä¼´ï¼Œé™ä½é¢¨éšªã€‚'}), (DB.BX1 = {s:'å±•æœƒ/BDæ‹“å®¢', sum:'é‡å° B ç«¯å®¢æˆ¶ï¼Œé€éåƒåŠ è¡Œæ¥­å±•æœƒã€ç·šä¸‹æ‹œè¨ªç­‰æ–¹å¼ï¼Œç²¾æº–ç²å–é«˜åƒ¹å€¼å®¢æˆ¶åå–®ã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯</b>', pb:'æº–å‚™å¥½æ¨™æº–åŒ–çš„ç”¢å“ä»‹ç´¹å’ŒæˆåŠŸæ¡ˆä¾‹ï¼Œæé«˜ç¾å ´è½‰åŒ–æ•ˆç‡ã€‚'}), (DB.B1 = {s:'æ–°æ‰‹å¼•å°', sum:'åœ¨ç”¨æˆ¶é¦–æ¬¡ä½¿ç”¨æ™‚ï¼Œæä¾›æ¸…æ™°ã€åˆ†æ­¥çš„å¼•å°ï¼Œå¹«åŠ©å…¶å¿«é€Ÿä¸Šæ‰‹ä¸¦å®Œæˆé—œéµæ“ä½œã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯ã€C ç«¯</b>', pb:'è¨­è¨ˆã€ŒAha! Momentã€å°å‘çš„å¼•å°æµç¨‹ï¼Œè€Œéä¸€æ¬¡æ€§å‘ˆç¾æ‰€æœ‰åŠŸèƒ½ã€‚'}), (DB.B2 = {s:'å ´æ™¯ç¶å®š', sum:'å°‡ç”¢å“åŠŸèƒ½èˆ‡ç”¨æˆ¶çš„é«˜é »ã€å‰›éœ€ç”Ÿæ´»/å·¥ä½œå ´æ™¯æ·±åº¦ç¶å®šï¼Œæå‡ä½¿ç”¨æ…£æ€§ã€‚<br><br><b>[é©ç”¨å°è±¡] C ç«¯</b>', pb:'å„ªå…ˆæ¥å…¥æ”¯ä»˜ã€é€šè¨Šã€äº¤é€šç­‰å ´æ™¯ï¼Œè®“ç”¨æˆ¶ã€Œä¸å¾—ä¸ç”¨ã€ã€‚'}), (DB.C1 = {s:'æé«˜å®¢å–®åƒ¹(M)', sum:'é€éå•†å“çµ„åˆã€åŠ åƒ¹è³¼ã€æ»¿é¡è´ˆç­‰æ–¹å¼ï¼Œæå‡ç”¨æˆ¶å–®æ¬¡äº¤æ˜“çš„é‡‘é¡ã€‚<br><br><b>[é©ç”¨å°è±¡] C ç«¯</b>', pb:'åœ¨æ”¯ä»˜å‰ç’°ç¯€ï¼ŒåŸºæ–¼ç”¨æˆ¶ç•«åƒé€²è¡Œå€‹æ€§åŒ–æ¨è–¦ã€‚'}), (DB.C2 = {s:'æé«˜é »æ¬¡(F)', sum:'é€éè¨‚é–±åˆ¶ã€æœƒå“¡ç©åˆ†ã€å®šæœŸæé†’ç­‰æ–¹å¼ï¼Œæå‡ç”¨æˆ¶åœ¨çµ±è¨ˆé€±æœŸå…§çš„è³¼è²·æ¬¡æ•¸ã€‚<br><br><b>[é©ç”¨å°è±¡] C ç«¯</b>', pb:'ç°¡åŒ–æ”¯ä»˜å’Œè¤‡è³¼æµç¨‹ï¼Œæä¾›ã€Œä¸€éµä¸‹å–®ã€ç­‰ä¾¿æ·åŠŸèƒ½ã€‚'}), (DB.C3 = {s:'äº¤å‰éŠ·å”®/é‡‘è', sum:'å‘ç¾æœ‰ç”¨æˆ¶æ¨è–¦ç›¸é—œä½†ä¸åŒçš„ç”¢å“æˆ–æœå‹™ï¼Œæˆ–æä¾›æ¶ˆè²»ä¿¡è²¸ã€åˆ†æœŸç­‰é‡‘èå·¥å…·ã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯ã€C ç«¯</b>', pb:'å¿…é ˆåŸºæ–¼ç”¨æˆ¶æ•¸æ“šå’Œé¢¨æ§æ¨¡å‹ï¼Œé¿å…ä¸ç›¸é—œçš„æ‰“æ“¾å’Œå£å¸³é¢¨éšªã€‚'}), (DB.D1 = {s:'LTV/CACåˆ†æ', sum:'å®šæœŸè¨ˆç®—ä¸¦ç›£æ§ LTV/CAC çš„æ¯”ç‡ï¼Œä½œç‚ºåˆ¤æ–·æ¥­å‹™å¥åº·åº¦å’Œæ“´å¼µæ½›åŠ›çš„æ ¸å¿ƒæŒ‡æ¨™ã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯ã€C ç«¯</b>', pb:'ä¸€èˆ¬èªç‚º LTV/CAC > 3 æ˜¯å¥åº·ä¸”å¯æ“´å¼µçš„ä¿¡è™Ÿã€‚'}), (DB.D2 = {s:'å„ªåŒ–ROIæ¸ é“', sum:'å°‡é ç®—å‹•æ…‹åœ°å¾æŠ•è³‡å›å ±ç‡(ROI)ä½çš„æ¸ é“ï¼Œè½‰ç§»åˆ° ROI é«˜çš„æ¸ é“ã€‚<br><br><b>[é©ç”¨å°è±¡] B ç«¯ã€C ç«¯</b>', pb:'è—‰åŠ©å¤šè§¸é»æ­¸å› (MTA)å’Œç‡ŸéŠ·çµ„åˆæ¨¡å‹(MMM)ç­‰å·¥å…·é€²è¡Œç§‘å­¸æ­¸å› ã€‚'}), (DB.S1 = {s:'01 å¸å¼•', sum:'ä»¥ä½åƒ¹æˆ–é«˜åƒ¹å€¼çš„æœå‹™ä½œç‚ºå…¥å£ï¼Œå¸å¼•å¤§é‡åˆå§‹ç”¨æˆ¶ã€‚', pb:'ä¾‹å¦‚ï¼šé¦–å–®1å…ƒã€å…è²»è©¦ç”¨ã€æä¾›æœ‰ç”¨çš„å·¥å…·æˆ–å…§å®¹ã€‚'}), (DB.S2 = {s:'02 é«˜æ½›åŠ›', sum:'å¾åˆå§‹ç”¨æˆ¶ä¸­ï¼Œè­˜åˆ¥ä¸¦ç¯©é¸å‡ºçœŸæ­£å°æ ¸å¿ƒæœå‹™æœ‰éœ€æ±‚çš„é«˜æ½›åŠ›ç›®æ¨™ç”¨æˆ¶ã€‚', pb:'åˆ†ææ—©æœŸç”¨æˆ¶è¡Œç‚ºæ•¸æ“šï¼Œæ‰¾åˆ°èˆ‡é•·æœŸç•™å­˜å’Œé«˜æ¶ˆè²»ç›¸é—œçš„ç‰¹å¾µã€‚'}), (DB.S3 = {s:'03 æ“´å ´æ™¯', sum:'åŸºæ–¼é«˜æ½›åŠ›ç”¨æˆ¶çš„éœ€æ±‚ï¼Œæ“´å±•ç”¢å“åŠŸèƒ½æˆ–æœå‹™å ´æ™¯ï¼Œå¢åŠ ç”¨æˆ¶é»æ€§ã€‚', pb:'ä¾‹å¦‚ï¼Œæ‰“è»Šè»Ÿé«”å¢åŠ é€é¤æœå‹™ï¼Œæ”¯ä»˜å·¥å…·å¢åŠ ç”Ÿæ´»ç¹³è²»åŠŸèƒ½ã€‚'}), (DB.S4 = {s:'04 æå‡é«”é©—', sum:'æŒçºŒæ‰“ç£¨ç”¢å“ï¼Œå„ªåŒ–æ ¸å¿ƒæµç¨‹é«”é©—ï¼Œä¸¦å»ºç«‹æœƒå“¡ã€ç©åˆ†ç­‰å›é¥‹é«”ç³»ã€‚', pb:'æ¸›å°‘æ“ä½œæ­¥é©Ÿã€æå‡éŸ¿æ‡‰é€Ÿåº¦ã€çµ¦äºˆå³æ™‚çš„æ­£é¢åé¥‹ã€‚'}), (DB.S5 = {s:'05 å›æµæ¨è–¦', sum:'æ»¿æ„çš„æ´»èºç”¨æˆ¶æœƒæŒçºŒå›è¨ªï¼Œä¸¦é€éå£ç¢‘å‘å¤–æ¨è–¦ï¼Œå¸¶ä¾†æ–°ç”¨æˆ¶ã€‚', pb:'è¨­è¨ˆåˆç†çš„åˆ†äº«çå‹µæ©Ÿåˆ¶ï¼Œè®“æ¨è–¦è¡Œç‚ºå°æ–°è€ç”¨æˆ¶éƒ½æœ‰åˆ©ã€‚'}), (DB.S6 = {s:'06 è¦æ¨¡æ“´å¤§', sum:'ç”¨æˆ¶å’Œäº¤æ˜“è¦æ¨¡çš„æ“´å¤§ï¼Œå¸¶ä¾†äº†æ›´å¤šæ•¸æ“šï¼Œå¯ä»¥é€²è¡Œæ›´ç²¾æº–çš„è¡ŒéŠ·å’Œæ¨è–¦ã€‚', pb:'å»ºç«‹æ•¸æ“šæ¨™ç±¤é«”ç³»å’Œç”¨æˆ¶ç•«åƒï¼Œæå‡äº¤å‰éŠ·å”®çš„æˆåŠŸç‡ã€‚'}), (DB.S7 = {s:'07 æˆæœ¬â†“åƒ¹å€¼â†‘', sum:'å£ç¢‘æ¨è–¦é™ä½äº†å¹³å‡ç²å®¢æˆæœ¬(CAC)ï¼Œç²¾æº–è¡ŒéŠ·æå‡äº†æ¯ç”¨æˆ¶åƒ¹å€¼(ARPU/LTV)ï¼Œå¢å¼·äº†ç›ˆåˆ©èƒ½åŠ›ï¼Œå¯ä»¥å°‡æ›´å¤šåˆ©æ½¤æŠ•å…¥åˆ°ç¬¬ä¸€æ­¥ï¼Œå¸å¼•æ›´å¤šç”¨æˆ¶ï¼Œé£›è¼ªåŠ é€Ÿã€‚', pb:''}), (DB.CS_HUB = {s:'ç”¢å“å†·å•Ÿå‹•', sum:'æŒ‡ç”¢å“åœ¨å¹¾ä¹æ²’æœ‰ç”¨æˆ¶å’Œå¸‚å ´èªçŸ¥çš„æƒ…æ³ä¸‹ï¼Œå¦‚ä½•ç²å–ç¬¬ä¸€æ‰¹æ ¸å¿ƒç”¨æˆ¶ï¼Œä¸¦å®Œæˆåˆæ­¥é©—è­‰çš„éç¨‹ã€‚', link:'æ˜¯å¾0åˆ°1çš„é—œéµéšæ®µï¼Œæ±ºå®šäº†ç”¢å“èƒ½å¦é †åˆ©é€²å…¥å¾ŒçºŒçš„æˆé•·è»Œé“ã€‚'}), (DB.CS1 = {s:'åäººæ•ˆæ‡‰', sum:'åˆ©ç”¨å½±éŸ¿åŠ›äººç‰©ï¼ˆKOLã€è¡Œæ¥­å°ˆå®¶ï¼‰çš„ä¿¡è­½å’Œè‡ªæœ‰æµé‡ï¼Œç‚ºç”¢å“é€²è¡ŒèƒŒæ›¸ï¼Œå¿«é€Ÿå»ºç«‹å¸‚å ´ä¿¡ä»»åº¦å’Œåˆå§‹ç”¨æˆ¶ç¾¤ã€‚', pb:'åˆä½œå‰è¦è©•ä¼° KOL çš„ç²‰çµ²ç•«åƒèˆ‡ç”¢å“ç›®æ¨™ç”¨æˆ¶æ˜¯å¦åŒ¹é…ã€‚'}), (DB.CS2 = {s:'çˆ†æ¬¾ç”¢å“', sum:'é›†ä¸­è³‡æºæ‰“é€ ä¸€å€‹ç”¨æˆ¶éœ€æ±‚æ¥µå¼·ã€èƒ½å¼•ç™¼è©±é¡Œçš„ã€Œçˆ†æ¬¾ã€æˆ–ã€Œæ®ºæ‰‹ç´šã€åŠŸèƒ½ï¼Œä»¥æ­¤å¸¶å‹•æ•´å€‹ç”¢å“çš„é—œæ³¨åº¦ã€‚', pb:'ä¾‹å¦‚ï¼šAI ç¹ªåœ–åŠŸèƒ½ã€è¶£å‘³å¿ƒç†æ¸¬è©¦ã€è¡Œæ¥­ç¨å®¶æ•¸æ“šå ±å‘Šã€‚'}), (DB.CS3 = {s:'é¦¬ç”²æ•ˆæ‡‰', sum:'ç”¨ä¸åŒçš„ç”¢å“åç¨±æˆ–å®šä½ï¼ˆé¦¬ç”²ï¼‰åœ¨å¤šå€‹æ¸ é“é€²è¡Œæ¨å»£ï¼Œæ¸¬è©¦ä¸åŒå¸‚å ´çš„åæ‡‰ï¼Œæˆ–ç‡Ÿé€ ã€Œå¾ˆå¤šäººéƒ½åœ¨ç”¨ã€çš„æ°›åœã€‚', pb:'æ³¨æ„ä¿æŒæ ¸å¿ƒé«”é©—ä¸€è‡´ï¼Œé¿å…å“ç‰Œæ··äº‚ã€‚å¸¸ç”¨æ–¼éŠæˆ²æˆ–ç¤¾äº¤ç”¢å“ã€‚'}), (DB.CS4 = {s:'ç¨®å­ç‰¹æ¬Š', sum:'é‚€è«‹ä¸€å°æ‰¹é«˜å“è³ªçš„ç¨®å­ç”¨æˆ¶é€²è¡Œå…§æ¸¬ï¼Œçµ¦äºˆä»–å€‘ç‰¹æ®Šèº«ä»½æˆ–æ¬Šç›Šï¼Œè®“ä»–å€‘æœ‰åƒèˆ‡æ„Ÿå’Œæ­¸å±¬æ„Ÿï¼Œä¸¦è—‰æ­¤æ‰“ç£¨ç”¢å“ã€‚', pb:'å»ºç«‹é«˜æ•ˆçš„ç”¨æˆ¶åé¥‹æ¸ é“ï¼ˆå¦‚ï¼šå°ˆå±¬ç¤¾ç¾¤ï¼‰ï¼Œä¸¦å°æœ‰æ•ˆåé¥‹çµ¦äºˆçå‹µã€‚'}), (DB.CS5 = {s:'å®šå‘é‚€è«‹', sum:'ä¸è¿½æ±‚å»£æ’’ç¶²ï¼Œè€Œæ˜¯ç²¾æº–åœ°å‘æœ€æœ‰å¯èƒ½æˆç‚ºæ ¸å¿ƒç”¨æˆ¶çš„å°åœˆå­ç™¼å‡ºé‚€è«‹ï¼Œç¢ºä¿æ—©æœŸç”¨æˆ¶çš„é«˜å“è³ªã€‚', pb:'ä¾‹å¦‚ï¼šè¨­è¨ˆå¸«ç¤¾ç¾¤ã€ç‰¹å®šæŠ€è¡“è«–å£‡çš„æˆå“¡ã€‚å“è³ªæ¯”æ•¸é‡æ›´é‡è¦ã€‚'}), (DB.CS6 = {s:'åª’é«”å ±å°', sum:'ä¸»å‹•èˆ‡ç§‘æŠ€åª’é«”ã€è¡Œæ¥­å‚ç›´åª’é«”æˆ–ç¤¾ç¾¤å¤§è™Ÿåˆä½œï¼Œé€éæ–°èç¨¿ã€æ·±åº¦è©•æ¸¬ç­‰æ–¹å¼ï¼Œè£½é€ è©±é¡Œï¼Œç²å¾—é›†ä¸­æ›å…‰ã€‚', pb:'æº–å‚™å¥½æœ‰æ–°èé»çš„ã€Œåª’é«”è³‡æ–™åŒ…ã€(Media Kit)ï¼Œæ–¹ä¾¿è¨˜è€…å ±å°ã€‚'});

  /* ===================== ç¹ªåœ–å¼•æ“ Start ===================== */
  let VIEW='overview';
  const NODE_REG={};

  function clearSVG(){ gLanes.innerHTML=''; gLinks.innerHTML=''; gNodes.innerHTML=''; gGroupTitles.innerHTML='' }

  function renderLanes(lanes){
    lanes?.forEach(l=>{
      const grp = document.createElementNS('http://www.w3.org/2000/svg','g');
      const r = document.createElementNS('http://www.w3.org/2000/svg','rect');
      r.setAttribute('x', l.x); r.setAttribute('y', l.y); r.setAttribute('width', l.w); r.setAttribute('height', l.h); r.setAttribute('class','lane-rect');
      const t = document.createElementNS('http://www.w3.org/2000/svg','text');
      t.setAttribute('x', l.x+4); t.setAttribute('y', l.y-8); t.setAttribute('class','lane-title'); t.textContent=l.title;
      grp.appendChild(r); grp.appendChild(t); gLanes.appendChild(grp);
    });
  }
  function renderGroupTitles(titles){
    titles?.forEach(t=>{
      const te = document.createElementNS('http://www.w3.org/2000/svg', 'text');
      te.setAttribute('x', t.x); te.setAttribute('y', t.y); te.setAttribute('class', 'group-title'); te.textContent = t.text;
      gGroupTitles.appendChild(te);
    });
  }

  function addNode(n){
    const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    g.setAttribute('class', `node ${n.type}`);
    g.dataset.id = n.id;
    g.setAttribute('tabindex', '0');
    
    const isMetric = n.type === 'metric';
    const w = n.w || (isMetric ? 190 : 220);
    const h = n.h || (isMetric ? 54 : 56);
    
    const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    rect.setAttribute('x', n.x - w / 2); rect.setAttribute('y', n.y - h / 2);
    rect.setAttribute('width', w); rect.setAttribute('height', h);
    g.appendChild(rect);

    const titleLines = n.title.split('\n');
    const hasSub = !!n.sub;
    const lineHeight = 16;
    const numLines = titleLines.length + (hasSub ? 1 : 0);
    const totalTextHeight = numLines * lineHeight - (hasSub ? 2 : 0);
    let currentY = n.y - (totalTextHeight / 2) + (lineHeight / 2);

    const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    title.setAttribute('x', n.x);
    title.setAttribute('text-anchor', 'middle');
    titleLines.forEach((line) => {
        const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
        tspan.setAttribute('x', n.x);
        tspan.setAttribute('y', currentY);
        tspan.textContent = line;
        title.appendChild(tspan);
        currentY += lineHeight;
    });
    g.appendChild(title);

    if (hasSub) {
        const sub = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        sub.setAttribute('x', n.x);
        sub.setAttribute('y', currentY);
        sub.setAttribute('text-anchor', 'middle');
        sub.setAttribute('class', 'sub');
        sub.textContent = n.sub;
        g.appendChild(sub);
    }

    if (n['data-bc']) g.dataset.bc = n['data-bc'].toUpperCase();
    gNodes.appendChild(g);
    NODE_REG[n.id] = { ...n, w, h };
  }

  function addLink(a,b,cls=''){
    const pa=NODE_REG[a], pb=NODE_REG[b]; if(!pa||!pb) return;
    const p1={x:pa.x,y:pa.y}, p2={x:pb.x,y:pb.y};
    const dx=(p2.x-p1.x)*0.5;
    const d=`M ${p1.x} ${p1.y} C ${p1.x+dx} ${p1.y}, ${p2.x-dx} ${p2.y}, ${p2.x} ${p2.y}`;
    const g = document.createElementNS('http://www.w3.org/2000/svg','g');
    g.setAttribute('class',`link ${cls}`); g.dataset.from=a; g.dataset.to=b;
    const p = document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d', d); p.setAttribute('marker-end','url(#arrow)');
    g.appendChild(p); gLinks.appendChild(g);
  }

  function render(view){
    clearSVG(); Object.keys(NODE_REG).forEach(k=>delete NODE_REG[k]);
    const data = view === 'overview' ? OVERVIEW : (view === 'fly7' ? FLY7 : COLD);
    if(data.lanes) renderLanes(data.lanes);
    renderGroupTitles(data.groupTitles);
    data.nodes.forEach(addNode);
    data.links.forEach(([a,b,c])=>addLink(a,b,c||''));
    updateToolbarState(view);
    applyToggles();
  }
  /* ===================== ç¹ªåœ–å¼•æ“ End ===================== */

  /* ===================== äº’å‹•é‚è¼¯ Start ===================== */
  const tglDrivers=$('#tglDrivers'), tglAARRR=$('#tglAARRR'), tglMetrics=$('#tglMetrics'), tglLoop=$('#tglLoop'), tglStrategy=$('#tglStrategy');

  function applyToggles(){
    const isOverview = VIEW === 'overview';
    if (!isOverview) {
      $$('#nodes .node').forEach(el => el.classList.remove('filtered-out'));
      $$('#links .link').forEach(el => el.classList.remove('filtered-out'));
      return;
    }
    
    const layerVisibility = {
        L0: tglDrivers.checked,
        L1: tglAARRR.checked,
        L2: tglMetrics.checked,
        L3: tglLoop.checked,
        L4: tglStrategy.checked,
    };

    $$('#nodes .node').forEach(el => {
        const n = NODE_REG[el.dataset.id];
        if (!n || !n.lane) return;
        const isVisible = layerVisibility[n.lane];
        el.classList.toggle('filtered-out', !isVisible);
    });
    
    gGroupTitles.style.opacity = tglStrategy.checked ? 1 : 0;
    refreshLinkVisibility();
  }

  function refreshLinkVisibility(){
    $$('#links .link').forEach(l=>{
      const fromNode = $(`#nodes .node[data-id='${l.dataset.from}']`);
      const toNode = $(`#nodes .node[data-id='${l.dataset.to}']`);
      const isFiltered = fromNode?.classList.contains('filtered-out') || toNode?.classList.contains('filtered-out');
      l.classList.toggle('filtered-out', isFiltered);
    });
  }
  
  function highlight(ids){
    $$('#nodes .node').forEach(n=>n.classList.remove('emph'));
    $$('#links .link').forEach(l=>l.classList.remove('emph-link'));
    ids.forEach(id=>{ const nd=$(`#nodes .node[data-id='${id}']`); if(nd) nd.classList.add('emph') });
    $$('#links .link').forEach(l=>{
        if (ids.includes(l.dataset.from) && ids.includes(l.dataset.to)) {
            l.classList.add('emph-link');
        }
    });
  }
  
  function selectNode(id){
    if(!id) return;
    const m = DB[id] || {};
    
    // å¡«å……å…§å®¹
    $('#ov-title').textContent = m.s || id;
    $('#ov-summary').innerHTML = m.sum || 'æš«ç„¡èªªæ˜';
    $('#ov-kpi').innerHTML = m.kpi || '';
    $('#ov-rel').textContent = m.link || '';
    $('#ov-pb').textContent = m.pb || '';
    
    // æ ¹æ“šå…§å®¹æ±ºå®šæ˜¯å¦é¡¯ç¤ºå€å¡Š
    $('#block-sum').style.display = 'block'; // Summary å€å¡Šç¸½æ˜¯é¡¯ç¤º
    $('#block-kpi').style.display = m.kpi ? 'block' : 'none';
    $('#block-rel').style.display = m.link ? 'block' : 'none';
    $('#block-pb').style.display = m.pb ? 'block' : 'none';

    const related = [id];
    $$('#links .link').forEach(l => {
        const f = l.dataset.from, t = l.dataset.to;
        if (f === id) related.push(t);
        if (t === id) related.push(f);
    });
    highlight([...new Set(related)]);
  }
  
  function showTip(nodeEl,e){
    if(!nodeEl) return;
    const id = nodeEl.dataset.id;
    const m = DB[id] || {};
    tip.innerHTML = `<b>${m.s || id}</b><br><span class="muted">${m.sum || ''}</span>`;
    const tr = tip.getBoundingClientRect();
    let left = e.clientX + 12, top = e.clientY + 12;
    if (left + tr.width > window.innerWidth) left = e.clientX - tr.width - 12;
    if (top + tr.height > window.innerHeight) top = e.clientY - tr.height - 12;
    tip.style.left = `${left}px`;
    tip.style.top = `${top}px`;
    tip.style.opacity = 1;
  }
  
  function hideTip(){ tip.style.opacity=0 }

  gNodes.addEventListener('click', e => { const node = e.target.closest('.node'); if (node && !node.classList.contains('filtered-out')) selectNode(node.dataset.id) });
  gNodes.addEventListener('keyup', e => { if (e.key === 'Enter' || e.key === ' ') { const node = e.target.closest('.node'); if (node && !node.classList.contains('filtered-out')) selectNode(node.dataset.id) }});
  gNodes.addEventListener('mousemove', e => { const node = e.target.closest('.node'); if (node && !node.classList.contains('filtered-out')) showTip(node,e) });
  gNodes.addEventListener('mouseleave', hideTip);

  function updateToolbarState(currentView) {
      const isOverview = currentView === 'overview';
      [tglDrivers, tglAARRR, tglMetrics, tglLoop, tglStrategy].forEach(tgl => tgl.disabled = !isOverview);
  }

  $$('input[name="view"]').forEach(r => r.addEventListener('change', e => {
      VIEW = e.target.value;
      render(VIEW);
  }));
  
  [tglDrivers, tglAARRR, tglMetrics, tglLoop, tglStrategy].forEach(tgl => tgl.addEventListener('change', applyToggles));

  function resetAll(){
    highlight([]);
    $('#ov-title').textContent = 'å¢é•·æ¨¡å‹äº’å‹•åœ–è­œ';
    $('#ov-summary').innerHTML = 'é»æ“Šå·¦å´ä»»ä¸€åœ–å¡Šï¼Œæˆ–ä½¿ç”¨ä¸Šæ–¹å·¥å…·åˆ—åˆ‡æ›è¦–åœ–èˆ‡ç¯©é¸ï¼Œä¾†æ¢ç´¢å¢é•·æ¨¡å‹ã€‚';
    
    // éš±è—é™¤ Summary å¤–çš„æ‰€æœ‰å€å¡Š
    $('#block-sum').style.display = 'block';
    $('#block-kpi').style.display = 'none';
    $('#block-rel').style.display = 'none';
    $('#block-pb').style.display = 'none';

    hideTip();
    
    $$('input[name="view"]').forEach(r=>{ if(r.value==='overview') r.checked=true });
    VIEW='overview';
    [tglDrivers, tglAARRR, tglMetrics, tglLoop, tglStrategy].forEach(tgl => tgl.checked = true);
    
    render(VIEW);
    selectNode('A');
  }
  $('#btnReset').addEventListener('click',resetAll);

  // --- åˆå§‹æ¸²æŸ“ ---
  render(VIEW);
  selectNode('A');
  /* ===================== äº’å‹•é‚è¼¯ End ===================== */
})();
</script>
</body>
</html>